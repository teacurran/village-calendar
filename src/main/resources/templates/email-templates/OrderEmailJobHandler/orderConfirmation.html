<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Confirmation</title>
    <style>
        {stylesheet}
    </style>
</head>
<body>
    <div class="outer-wrapper">
        <h1>ðŸŽ‰ Thank You for Your Order!</h1>

        <p>Hi {#if order.user}{order.user.displayName ?: order.user.email}{#else}{order.customerEmail ?: 'Valued Customer'}{/if},</p>

        <p>We're excited to confirm that we've received your order for your custom calendar!</p>

        <div class="highlight-box">
            <strong>Order Total: ${order.totalPrice}</strong>
            <p style="margin: 0; color: white;">Order #: {order.orderNumber}</p>
        </div>

        <h2>ðŸ“‹ Order Details</h2>

        {#for item in order.items}
        <div class="detail-box">
            {#if previewImages.size > item_index && previewImages.get(item_index)}
            <div style="text-align: center; margin-bottom: 15px;">
                <img src="{previewImages.get(item_index)}" alt="Calendar Preview" style="max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 4px;" />
            </div>
            {/if}
            <strong>{item.description ?: 'Calendar'}</strong> ({item.getYear()})
            <div style="margin-top: 5px;">
                Quantity: {item.quantity} | ${item.unitPrice} each
            </div>
        </div>
        {/for}

        <div class="detail-box" style="margin-top: 20px;">
            <table style="width: 100%; border-collapse: collapse;">
                <tr>
                    <td style="padding: 8px 0; color: #374151;">Subtotal:</td>
                    <td style="padding: 8px 0; text-align: right; color: #374151;">${order.subtotal ?: order.totalPrice}</td>
                </tr>
                {#if order.shippingCost}
                <tr>
                    <td style="padding: 8px 0; color: #374151;">Shipping:</td>
                    <td style="padding: 8px 0; text-align: right; color: #374151;">${order.shippingCost}</td>
                </tr>
                {/if}
                {#if order.taxAmount}
                <tr>
                    <td style="padding: 8px 0; color: #374151;">Tax:</td>
                    <td style="padding: 8px 0; text-align: right; color: #374151;">${order.taxAmount}</td>
                </tr>
                {/if}
                <tr style="border-top: 2px solid #e5e7eb;">
                    <td style="padding: 12px 0; font-weight: bold; color: #111827;">Total:</td>
                    <td style="padding: 12px 0; text-align: right; font-weight: bold; color: #111827; font-size: 18px;">${order.totalPrice}</td>
                </tr>
            </table>
        </div>

        <div class="detail-box">
            <strong>Order Date:</strong>
            {order.paidAt ?: order.created}
        </div>

        <h2>ðŸ“¦ Shipping Address</h2>

        {#if order.shippingAddress}
        <div class="shipping-box">
            {#if order.shippingAddress.has('name') && !order.shippingAddress.get('name').isNull()}
            <strong>{order.shippingAddress.get('name').asText()}</strong><br>
            {/if}
            {#if order.shippingAddress.has('line1') && !order.shippingAddress.get('line1').isNull()}
            {order.shippingAddress.get('line1').asText()}<br>
            {/if}
            {#if order.shippingAddress.has('line2') && !order.shippingAddress.get('line2').isNull()}
            {order.shippingAddress.get('line2').asText()}<br>
            {/if}
            {#if order.shippingAddress.has('city') && !order.shippingAddress.get('city').isNull()}
            {order.shippingAddress.get('city').asText()},
            {/if}
            {#if order.shippingAddress.has('state') && !order.shippingAddress.get('state').isNull()}
            {order.shippingAddress.get('state').asText()}
            {/if}
            {#if order.shippingAddress.has('postalCode') && !order.shippingAddress.get('postalCode').isNull()}
            {order.shippingAddress.get('postalCode').asText()}<br>
            {/if}
            {#if order.shippingAddress.has('country') && !order.shippingAddress.get('country').isNull()}
            {order.shippingAddress.get('country').asText()}
            {/if}
        </div>
        {#else}
        <div class="detail-box">
            <em>Shipping address will be confirmed separately.</em>
        </div>
        {/if}

        <h2>ðŸ“… What's Next?</h2>

        <p>Your custom calendar is now in production! Here's what to expect:</p>

        <ul style="color: #374151; font-size: 16px; line-height: 1.8;">
            <li><strong>Processing:</strong> We'll prepare your calendar for printing (1-2 business days)</li>
            <li><strong>Printing:</strong> High-quality printing of your custom design (3-5 business days)</li>
            <li><strong>Shipping:</strong> Your calendar will be carefully packaged and shipped to you</li>
        </ul>

        <p>We'll send you another email with tracking information once your order ships.</p>

        <div style="text-align: center; margin: 30px 0;">
            <a href="{baseUrl}/order/{order.orderNumber}/{order.id}" class="button">View Order Status</a>
        </div>

        <div class="footer">
            <p><strong>Questions?</strong></p>
            <p>Contact us at <a href="mailto:support@villagecompute.com">support@villagecompute.com</a></p>
            <p style="margin-top: 20px;">
                Village Compute Calendar<br>
                <a href="{baseUrl}">{baseUrl}</a>
            </p>
        </div>
    </div>
</body>
</html>
