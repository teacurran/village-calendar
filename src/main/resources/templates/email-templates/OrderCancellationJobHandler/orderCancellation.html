<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Cancellation Confirmation</title>
    <style>
        {stylesheet}
        .cancellation-box {
            background-color: #fef2f2;
            border-left: 4px solid #ef4444;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .refund-box {
            background-color: #f0f9ff;
            border-left: 4px solid #0ea5e9;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="outer-wrapper">
        <h1>Order Cancellation Confirmation</h1>

        <p>Hi {order.user.displayName ?: order.user.email},</p>

        <p>This email confirms that your order has been cancelled as requested.</p>

        <div class="cancellation-box">
            <strong style="color: #dc2626; display: block; margin-bottom: 5px;">Order #{order.orderNumber} - Cancelled</strong>
            <span style="color: #991b1b; font-size: 14px;">Order ID: {order.id}</span>
        </div>

        <h2>üìã Order Details</h2>

        {#for item in order.items}
        <div class="detail-box">
            <strong>{item.description}</strong> ({item.getYear()}) x {item.quantity}
        </div>
        {/for}

        <div class="detail-box">
            <strong>Order Total:</strong>
            ${order.totalPrice}
        </div>

        <div class="detail-box">
            <strong>Cancelled Date:</strong>
            {order.cancelledAt.toString()}
        </div>

        {#if order.notes}
        <h2>üìù Cancellation Details</h2>

        <div class="detail-box">
            <strong>Reason:</strong>
            {order.notes}
        </div>
        {/if}

        {#if includeRefundNote}
        <h2>üí≥ Refund Information</h2>

        <div class="refund-box">
            <strong style="color: #0369a1; display: block; margin-bottom: 10px;">Your refund is being processed</strong>
            <p style="margin: 5px 0; color: #075985; font-size: 14px;">
                Since your order was paid, a full refund of <strong>${order.totalPrice}</strong> will be issued to your original payment method.
            </p>
            <p style="margin: 5px 0; color: #075985; font-size: 14px;">
                <strong>Expected timeframe:</strong> 5-10 business days
            </p>
            <p style="margin: 5px 0; color: #075985; font-size: 14px;">
                The exact timing depends on your bank or credit card issuer.
            </p>
        </div>
        {/if}

        <h2>üîç What's Next?</h2>

        {#if includeRefundNote}
        <ul style="color: #374151; font-size: 16px; line-height: 1.8;">
            <li><strong>Refund Processing:</strong> We'll process your refund within 1-2 business days</li>
            <li><strong>Payment Method:</strong> The refund will be credited to your original payment method</li>
            <li><strong>Confirmation:</strong> You'll receive a separate email when the refund is processed</li>
            <li><strong>Bank Processing:</strong> Allow 5-10 business days for the refund to appear in your account</li>
        </ul>
        {#else}
        <p>Since no payment was processed for this order, no refund is necessary.</p>
        {/if}

        <h2>üí° We'd Love to See You Again</h2>

        <p>We're sorry this order didn't work out, but we hope you'll consider ordering a custom calendar in the future.</p>

        <div style="text-align: center; margin: 30px 0;">
            <a href="https://calendar.villagecompute.com" class="button">Browse Calendar Templates</a>
        </div>

        <p>If you have any questions about this cancellation or your refund, please don't hesitate to reach out to our support team.</p>

        <div class="footer">
            <p><strong>Questions?</strong></p>
            <p>Contact us at <a href="mailto:support@villagecompute.com">support@villagecompute.com</a></p>
            <p style="margin-top: 20px;">
                Village Compute Calendar<br>
                <a href="https://calendar.villagecompute.com">calendar.villagecompute.com</a>
            </p>
        </div>
    </div>
</body>
</html>
